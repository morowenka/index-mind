# Спринт 1

## Описание

Создание первого прототипа Mac-приложения с базовой функциональностью (ClickHouse + FAISS + Haystack)

---

## **Цели Спринта:**

1. **Создать приложение для Mac**, которое предоставит начальный UI для управления процессом индексации и поиска.
2. Настроить **Python-бэкэнд для обработки данных**, который будет выполнять индексацию и поиск по документам через **FAISS** и **ClickHouse**.
3. Сделать структуру приложения модульной, заложив основу для работы с разными типами данных (документы, изображения, переписки).
4. Пройти полный цикл от создания **инфраструктуры приложения (UI + бэкэнд)** до полноценной индексации тестового набора данных и поиска по ним.

---

## **1. Разработка общей структуры приложения**

На этом этапе нужно будет продумать архитектуру вашего Mac-приложения, чтобы оно было легко масштабируемым и модульным. Начнем мы с простого **интерфейса** (UI), который будет взаимодействовать с вашим **бэкэндом на Python** для индексирования и поиска данных.

**Краткая схема архитектуры приложения:**

1. **Frontend (UI)**: Интерфейс приложения, через который можно запускать индексацию, добавлять папки с файлами и запускать поиск по данным.
2. **Backend (Python)**: Отвечает за индексацию документов и обработку запросов. Backend работает с **ClickHouse** (для метаданных) и **FAISS** (для эмбеддингов).
3. **Работа с данными**: Модульные скрипты, которые будут индексировать текстовые документы и, позднее, другие типы данных (изображения, переписки).

**Модульный дизайн системы:**

- **Модуль документов:** Индексация и поиск по текстам.
- **Модуль изображений:** Индексация и поиск по файлам изображений.
- **Модуль переписок:** Поддержка Telegram и ВКонтакте чатов: в будущем.

Начнем с разработки простого минималистичного UI для взаимодействия с вашим Python-бэкэндом.

---

## **2. Бэкенд: Настройка Python-проекта (ClickHouse + FAISS + Haystack)**

**А. Формирование основной инфраструктуры для Python-бэкэнда:**

1. **Создание виртуального окружения:** Для управляемого управления зависимостями создадим виртуальное окружение:

   ```bash
   python3 -m venv env
   source env/bin/activate
   ```

2. **Установка необходимых зависимостей:**
   - **FAISS для эмбеддингов**.
   - **ClickHouse для метаданных** через `clickhouse-driver`.
   - **Haystack** для предварительных шагов RAG (Retrieval-Augmented Generation).

   Все нужные библиотеки можно собрать в **`requirements.txt`**, и файл будет содержать основные зависимости:

   ```txt
   clickhouse-driver
   haystack[faiss]
   transformers
   pyobjc-framework-Cocoa  # Поддержка Cocoa для интерфейса Mac
   python-dotenv
   ```

3. **Структура бэкэнда:**
   - Файлы и модули для обработки различных типов данных.
   - Модули для взаимодействия с ClickHouse и FAISS.

---

## **3. Frontend: Создание интерфейса Mac**

Используя **Swift** или **Cocoa**, мы построим приложение с компактным UI, который будет взаимодействовать с Python-бэкэндом. На этом этапе интерфейс будет простым, поддерживая:

1. **Кнопка индексации**: Пользователь сможет выбрать папку с документами, которые будет индексировать приложение.
2. **Кнопка поиска**: Открыть окно поиска — реализуем простую форму, где пользователь может ввести запрос, а результаты (например, ссылки на документы или отрывки) будут показаны в списке.

**Ключевые элементы интерфейса:**

1. **Выбор папки для индексации**: Важная часть UI — возможность выбрать папку с документами для обработки.
2. **Отображение статуса индексации**: Когда пользователи запускают индексацию, они должны видеть индикатор процесса (например, прогресс-бар).
3. **Поле для ввода поисковых запросов** и результаты поискового запроса.

Соответствие этим элементам обеспечит минимальную, но полезную функциональность при первой сборке приложения.

**Пример структуры интерфейса:**

- **Главное окно** приложения:
  - Поле для выбора папки с документами для индексации.
  - Кнопка для запуска процесса индексации.
  - Поле для ввода поискового запроса.
  - Окно для выдачи результатов поиска.

---

## **4. Процесс индексации документов: Разбиение на модули и интеграция**

**Модульная структура индексации:**

1. **Модуль текстов**: Выполняет индексацию и разбиение текстов на отрывки (chunks).
   - **Задача этого модуля**: обработка текстовых файлов, создание эмбеддингов с помощью моделей Hugging Face, сохранение эмбеддингов в FAISS и метаданных в ClickHouse.
   - **Модуль будет содержать** встроенную функцию для индексирования данных и возврата результатов для UI.

2. **Модуль изображений** (будет расширено в следующих спринтах):
   - Структура для индексации изображений с поддержкой эмбеддингов (CLIP) и их связей.

---

## **5. Взаимодействие Python и macOS (Frontend–Backend Integration)**

Чтобы способствовать взаимодействию между вашим UI на **Swift/Cocoa** (Frontend) и **бэкэндом на Python**, будем использовать механизм запуска Python-скриптов из Swift:

1. **Запуск Python скриптов из Swift:**
   - Использование библиотек **Process** и **Pipe** для запуска Python-скриптов и получения результатов в **Swift**.

   Примерная схема:
   - Автоматический запуск при нажатии на кнопку индексации/поиска.
   - Взаимодействие с данные через Python-запросы и отображение результатов.

---

## **6. Финальная сборка: Прототип приложения**

После настройки бэкэнда и UI нужно интегрировать все компоненты вместе и протестировать:

1. Запустить приложение для того, чтобы:
   - Стартовать процесс индексации на основе выбора папки.
   - Убедиться, что документы будут проиндексированы: эмбеддинги сохранятся в **FAISS**, а метаданные попадут в БД **ClickHouse**.
   - Реализовать удобную систему поиска с выводом списка найденных отрывков документа (с результатами через FAISS).

**Важные моменты**:

- Приведенный процесс можно завершить за неделю, поскольку основная цель — создать каркас для приложения.

---

## **Неделя завершится:**

**Результаты:**

1. **Рабочая структура модульного приложения** — базовое **Mac-приложение**, позволяющее:
   - Запускать **базовую индексацию документов** по файлам.
   - Хранить **эмбеддинги в FAISS** и **метаданные в ClickHouse**.
   - Искать по проиндексированным документам и получать результаты поиска.

2. **Старт взаимодействия Frontend (UI) с Backend (Python).**

Этот прототип положит фундамент для следующих спринтов, где добавятся модули для работы с изображениями и переписками, а также автоматизация процесса индексации перед завершением работы системы.
